{
  "openapi": "3.0.2",
  "info": {
    "title": "Tsundoku",
    "version": "0.0.1",
    "license": {
      "name": "Mozilla Public License 2.0",
      "url": "https://www.mozilla.org/en-US/MPL/2.0/"
    }
  },
  "servers": [
    {
      "url": "http://{host}:{port}/api/v1",
      "variables": {
        "host": {
          "default": "localhost",
          "description": "The location Tsundoku is hosted at."
        },
        "port": {
          "default": "6439",
          "description": "The port that Tsundoku is bound to."
        }
      }
    }
  ],
  "paths": {
    "/shows": {
      "get": {
        "description": "Returns all shows that are stored in the database.",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [
                      "id_",
                      "title",
                      "desired_format",
                      "desired_folder",
                      "season",
                      "episode_offset",
                      "watch",
                      "created_at",
                      "metadata"
                    ],
                    "properties": {
                      "id_": {
                        "type": "integer",
                        "readOnly": true
                      },
                      "title": {
                        "type": "string"
                      },
                      "desired_format": {
                        "description": "Desired file formatting.",
                        "type": "string"
                      },
                      "desired_folder": {
                        "description": "Desired destination folder.",
                        "type": "string"
                      },
                      "season": {
                        "description": "Season number for formatting.",
                        "type": "integer"
                      },
                      "episode_offset": {
                        "description": "Positive or negative value for offsetting the episode number when formatting.",
                        "type": "integer"
                      },
                      "watch": {
                        "description": "Whether or not to check RSS feeds for this show.",
                        "type": "boolean"
                      },
                      "created_at": {
                        "description": "When the show was added to the database as an ISO 8601 formatted string.",
                        "type": "string",
                        "readOnly": true
                      },
                      "metadata": {
                        "description": "Object containing general show metadata.",
                        "type": "object",
                        "required": [
                          "show_id"
                        ],
                        "properties": {
                          "show_id": {
                            "description": "ID of the show that this object relates to.",
                            "type": "integer",
                            "readOnly": true
                          },
                          "kitsu_id": {
                            "description": "ID of the show on Kitsu.",
                            "type": "integer"
                          },
                          "slug": {
                            "description": "Shortened slug of show title.",
                            "type": "string"
                          },
                          "status": {
                            "description": "Airing status of the show.",
                            "type": "string",
                            "enum": [
                              "current",
                              "finished",
                              "tba",
                              "unreleased",
                              "upcoming"
                            ]
                          },
                          "poster": {
                            "description": "URL to a poster image of the show.",
                            "type": "string"
                          }
                        }
                      },
                      "entries": {
                        "type": "array",
                        "description": "List of entries for this show.",
                        "items": {
                          "type": "object",
                          "required": [
                            "id",
                            "show_id",
                            "episode",
                            "state",
                            "last_update"
                          ],
                          "properties": {
                            "id": {
                              "description": "Internal entry identifier.",
                              "type": "integer"
                            },
                            "show_id": {
                              "description": "ID of the show that this object relates to.",
                              "type": "integer"
                            },
                            "episode": {
                              "description": "Episode that this entry relates to.",
                              "type": "integer"
                            },
                            "state": {
                              "description": "Internal state of the entry.",
                              "type": "string",
                              "enum": [
                                "downloading",
                                "downloaded",
                                "renamed",
                                "moved",
                                "completed"
                              ]
                            },
                            "torrent_hash": {
                              "description": "Hash of the torrent for this entry.",
                              "type": "string"
                            },
                            "file_path": {
                              "description": "Location of the entry on disk",
                              "type": "string"
                            },
                            "last_update": {
                              "description": "Last update time of the entry as an ISO 8601 formatted string.",
                              "type": "string"
                            }
                          }
                        }
                      },
                      "webhooks": {
                        "type": "array",
                        "description": "List of webhooks for this show.",
                        "items": {
                          "type": "object",
                          "required": [
                            "show_id",
                            "base",
                            "triggers"
                          ],
                          "properties": {
                            "show_id": {
                              "description": "ID of the show that this webhook belongs to.",
                              "type": "integer",
                              "readOnly": true
                            },
                            "base": {
                              "description": "The webhook base that this webhook belongs to.",
                              "readOnly": true,
                              "type": "object",
                              "required": [
                                "base_id",
                                "name",
                                "service",
                                "url",
                                "content_fmt"
                              ],
                              "properties": {
                                "base_id": {
                                  "description": "ID of the webhook base",
                                  "type": "integer"
                                },
                                "name": {
                                  "description": "Name of the webhook base.",
                                  "type": "string"
                                },
                                "service": {
                                  "description": "Service that this webhook base posts to.",
                                  "type": "string",
                                  "enum": [
                                    "discord",
                                    "slack"
                                  ]
                                },
                                "url": {
                                  "description": "URL that this webhook base posts to.",
                                  "type": "string"
                                },
                                "content_fmt": {
                                  "description": "Content that will be formatted with entry information.",
                                  "type": "string"
                                },
                                "valid": {
                                  "description": "Whether or not this webhook base is able to be posted to.",
                                  "type": "boolean"
                                }
                              }
                            },
                            "triggers": {
                              "description": "List of actions that trigger this webhook.",
                              "type": "array",
                              "items": {
                                "maxLength": 5,
                                "type": "string",
                                "enum": [
                                  "downloading",
                                  "downloaded",
                                  "renamed",
                                  "moved",
                                  "completed"
                                ]
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

